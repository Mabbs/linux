{
  "version": 3,
  "sources": ["../src/build/sections.json", "../src/bytes.ts", "../src/devicetree.ts", "../src/virtio.ts", "../src/index.ts"],
  "sourcesContent": ["{\n  \".data.once\": [191656, 635],\n  \".data..percpu\": [195136, 8176],\n  \".data..percpu..shared_aligned\": [230080, 3216],\n  \".init.setup\": [691716, 972],\n  \"__param\": [696060, 1800],\n  \".initcall7.init\": [697908, 64],\n  \".initcallrootfs.init\": [697972, 4],\n  \".initcall1.init\": [697976, 32],\n  \".initcall6.init\": [698008, 160],\n  \".initcallearly.init\": [698168, 44],\n  \".initcall5.init\": [698212, 108],\n  \".initcall4.init\": [698320, 64],\n  \".initcall2.init\": [707396, 28],\n  \".con_initcall.init\": [712660, 8],\n  \".initcall3s.init\": [712668, 4],\n  \".initcall7s.init\": [712672, 4]\n}\n", "import { assert } from \"./util\";\n\nexport interface Type<T> {\n  get(dv: DataView, offset: number): T;\n  set(dv: DataView, offset: number, value: T): void;\n  size: number;\n}\nexport type Unwrap<T> = T extends Type<infer U> ? U : never;\n\nexport function Struct<T extends object>(\n  layout: { [K in keyof T]: Type<T[K]> },\n) {\n  let size = 0;\n\n  return class {\n    #dv: DataView;\n    constructor(view: ArrayBufferView) {\n      this.#dv = new DataView(view.buffer, view.byteOffset, view.byteLength);\n    }\n\n    static {\n      for (\n        const [key, type] of Object.entries(\n          layout as Record<PropertyKey, Type<unknown>>,\n        )\n      ) {\n        const offset = size;\n        Object.defineProperty(this.prototype, key, {\n          get() {\n            return type.get(this.#dv, offset);\n          },\n          set(value) {\n            type.set(this.#dv, offset, value);\n          },\n        });\n        size += type.size;\n      }\n    }\n\n    static get(dv: DataView, offset: number) {\n      if (offset !== 0) dv = new DataView(dv.buffer, dv.byteOffset + offset);\n      return new this(dv);\n    }\n    static set(dv: DataView, offset: number, value: T) {\n      if (offset !== 0) dv = new DataView(dv.buffer, dv.byteOffset + offset);\n      Object.assign(new this(dv), value);\n    }\n    static size = size;\n\n    toJSON() {\n      const obj = {} as T;\n      for (const key in layout) {\n        obj[key] = (this as unknown as T)[key];\n      }\n      return obj;\n    }\n  } as { new (view: ArrayBufferView): T } & Type<T>;\n}\n\nexport function FixedArray<T>(\n  type: Type<T>,\n  length: number,\n): Type<T[]> {\n  assert(Number.isInteger(length) && length > 0);\n  return {\n    get(dv, offset) {\n      const arr = Array<T>(length);\n      for (let i = 0; i < length; i++) {\n        arr[i] = type.get(dv, offset + type.size * i);\n      }\n      return arr;\n    },\n    set(dv, offset, value) {\n      for (let i = 0; i < length; i++) {\n        type.set(dv, offset + type.size * i, value[i]!);\n      }\n    },\n    size: type.size * length,\n  };\n}\n\nexport const U8: Type<number> = {\n  get(dv, offset) {\n    return dv.getUint8(offset);\n  },\n  set(dv, offset, value) {\n    dv.setUint8(offset, value);\n  },\n  size: 1,\n};\nexport const U16LE: Type<number> = {\n  get(dv, offset) {\n    return dv.getUint16(offset, true);\n  },\n  set(dv, offset, value) {\n    dv.setUint16(offset, value, true);\n  },\n  size: 2,\n};\nexport const U32LE: Type<number> = {\n  get(dv, offset) {\n    return dv.getUint32(offset, true);\n  },\n  set(dv, offset, value) {\n    dv.setUint32(offset, value, true);\n  },\n  size: 4,\n};\nexport const U64LE: Type<bigint> = {\n  get(dv, offset) {\n    return dv.getBigUint64(offset, true);\n  },\n  set(dv, offset, value) {\n    dv.setBigUint64(offset, value, true);\n  },\n  size: 8,\n};\nexport const U16BE: Type<number> = {\n  get(dv, offset) {\n    return dv.getUint16(offset, false);\n  },\n  set(dv, offset, value) {\n    dv.setUint16(offset, value, false);\n  },\n  size: 2,\n};\nexport const U32BE: Type<number> = {\n  get(dv, offset) {\n    return dv.getUint32(offset, false);\n  },\n  set(dv, offset, value) {\n    dv.setUint32(offset, value, false);\n  },\n  size: 4,\n};\nexport const U64BE: Type<bigint> = {\n  get(dv, offset) {\n    return dv.getBigUint64(offset, false);\n  },\n  set(dv, offset, value) {\n    dv.setBigUint64(offset, value, false);\n  },\n  size: 8,\n};\n\nexport interface Allocated<T> {\n  value: T;\n}\n\nexport class Bytes {\n  #array: Uint8Array;\n  length = 0;\n\n  get capacity() {\n    return this.#array.length;\n  }\n  get array() {\n    return this.#array.slice(0, this.length);\n  }\n\n  constructor(capacity = 32) {\n    this.#array = new Uint8Array(capacity);\n  }\n\n  #ensure_capacity(capacity: number) {\n    if (this.#array.length < capacity) {\n      let length = this.#array.length;\n      while (length < capacity) length *= 2;\n      const next = new Uint8Array(length);\n      next.set(this.#array);\n      this.#array = next;\n      this.#dv = undefined;\n    }\n  }\n\n  bump(length: number) {\n    const offset = this.length;\n    this.#ensure_capacity(this.length + length);\n    this.length += length;\n    return offset;\n  }\n\n  append(bytes: Uint8Array) {\n    const offset = this.bump(bytes.length);\n    this.#array.set(bytes, offset);\n  }\n\n  #dv?: DataView;\n  get dv() {\n    return this.#dv ??= new DataView(this.#array.buffer);\n  }\n\n  alloc<T>(type: Type<T>): Allocated<T> {\n    const offset = this.bump(type.size);\n    const self = this;\n    return {\n      get value() {\n        return type.get(self.dv, offset);\n      },\n      set value(value: T) {\n        type.set(self.dv, offset, value);\n      },\n    };\n  }\n}\n", "import {\n  type Allocated,\n  Bytes,\n  Struct,\n  U32BE,\n  U64BE,\n  U8,\n  type Unwrap,\n} from \"./bytes.ts\";\nimport { assert, unreachable } from \"./util.ts\";\n\nconst FDT_MAGIC = 0xd00dfeed;\nconst FDT_BEGIN_NODE = 0x00000001;\nconst FDT_END_NODE = 0x00000002;\nconst FDT_PROP = 0x00000003;\nconst FDT_END = 0x00000009;\nconst NODE_NAME_MAX_LEN = 31;\nconst PROPERTY_NAME_MAX_LEN = 31;\n\nexport interface DeviceTreeNode {\n  [key: string]: DeviceTreeNode | DeviceTreeProperty;\n}\ntype DeviceTreeProperty =\n  | string\n  | number\n  | bigint\n  | readonly number[]\n  | Uint8Array\n  | Uint16Array\n  | Uint32Array\n  | BigUint64Array\n  | ArrayBuffer\n  | undefined;\n\n// https://devicetree-specification.readthedocs.io/en/latest/chapter5-flattened-format.html\nconst FdtHeader = Struct({\n  magic: U32BE,\n  totalsize: U32BE,\n  off_dt_struct: U32BE,\n  off_dt_strings: U32BE,\n  off_mem_rsvmap: U32BE,\n  version: U32BE,\n  last_comp_version: U32BE,\n  boot_cpuid_phys: U32BE,\n  size_dt_strings: U32BE,\n  size_dt_struct: U32BE,\n});\n\nconst FdtReserveEntry = Struct({\n  address: U64BE,\n  size: U64BE,\n});\n\nconst Property = Struct({\n  len: U32BE,\n  nameoff: U32BE,\n});\ntype Property = Unwrap<typeof Property>;\n\nfunction align(bytes: Bytes, alignment: number) {\n  const offset = bytes.length % alignment;\n  if (offset !== 0) {\n    for (let j = 0; j < alignment - offset; j++) bytes.alloc(U8);\n  }\n}\n\nexport function generate_devicetree(tree: DeviceTreeNode, {\n  memory_reservations = [],\n  boot_cpu_id = 0,\n}: {\n  memory_reservations?: Array<\n    { address: number; size: number }\n  >;\n  boot_cpu_id?: number;\n} = {}) {\n  const bytes = new Bytes(1024);\n  const strings: Record<string, Allocated<Property>[]> = {};\n  const header = bytes.alloc(FdtHeader);\n\n  function walk_tree(node: DeviceTreeNode, name: string) {\n    align(bytes, 4);\n    bytes.alloc(U32BE).value = FDT_BEGIN_NODE;\n\n    const encodedName = new TextEncoder().encode(name);\n    assert(\n      encodedName.byteLength <= NODE_NAME_MAX_LEN,\n      `property name too long: ${name}`,\n    );\n    bytes.append(encodedName);\n    bytes.alloc(U8).value = 0;\n    align(bytes, 4);\n\n    const children = Object.entries(node).filter(\n      ([, value]) => typeof value === \"object\" && value?.constructor === Object,\n    ) as [string, DeviceTreeNode][];\n\n    const properties = Object.entries(node).filter(\n      ([, value]) =>\n        !(typeof value === \"object\" && value?.constructor === Object),\n    ) as [string, DeviceTreeProperty][];\n\n    for (const [name, prop] of properties) {\n      align(bytes, 4);\n      bytes.alloc(U32BE).value = FDT_PROP;\n      const property = bytes.alloc(Property);\n\n      assert(\n        new TextEncoder().encode(name).byteLength <= PROPERTY_NAME_MAX_LEN,\n        `property name too long: ${name}`,\n      );\n      (strings[name] ??= []).push(property);\n\n      let value: ArrayBuffer;\n      switch (typeof prop) {\n        case \"number\":\n          value = new Uint32Array(1).buffer;\n          new DataView(value).setUint32(0, prop);\n          break;\n        case \"bigint\":\n          value = new BigUint64Array(1).buffer;\n          new DataView(value).setBigUint64(0, prop);\n          break;\n        case \"string\":\n          value = new TextEncoder().encode(`${prop}\\0`).buffer;\n          break;\n        case \"object\":\n          if (\n            prop instanceof Uint8Array ||\n            prop instanceof Uint16Array ||\n            prop instanceof Uint32Array ||\n            prop instanceof BigUint64Array\n          ) {\n            value = prop.buffer;\n          } else if (prop instanceof ArrayBuffer) {\n            value = prop;\n          } else {\n            value = new Uint32Array(prop.length).buffer;\n            const dv = new DataView(value);\n            for (const [i, n] of prop.entries()) {\n              dv.setUint32(i * 4, n);\n            }\n          }\n          break;\n        case \"undefined\":\n          value = new Uint8Array().buffer;\n          break;\n        default:\n          unreachable(prop, `unsupported prop type: ${typeof prop}`);\n      }\n      property.value.len = value.byteLength;\n      bytes.append(new Uint8Array(value));\n      align(bytes, 4);\n    }\n    for (const [name, child] of children) walk_tree(child, name);\n\n    align(bytes, 4);\n    bytes.alloc(U32BE).value = FDT_END_NODE;\n  }\n\n  Object.assign(header.value, {\n    magic: FDT_MAGIC,\n    version: 17,\n    last_comp_version: 16,\n    boot_cpuid_phys: boot_cpu_id,\n  });\n\n  align(bytes, 8);\n\n  header.value.off_mem_rsvmap = bytes.length;\n  for (const { address, size } of memory_reservations) {\n    bytes.alloc(FdtReserveEntry).value = {\n      address: BigInt(address),\n      size: BigInt(size),\n    };\n  }\n  bytes.alloc(FdtReserveEntry).value = { address: 0n, size: 0n };\n\n  const begin_dt_struct = bytes.length;\n  header.value.off_dt_struct = begin_dt_struct;\n  walk_tree(tree, \"\");\n  bytes.alloc(U32BE).value = FDT_END;\n  header.value.size_dt_struct = bytes.length - begin_dt_struct;\n\n  const begin_dt_strings = bytes.length;\n  header.value.off_dt_strings = begin_dt_strings;\n  for (const [str, refs] of Object.entries(strings)) {\n    const offset = bytes.length;\n    bytes.append(new TextEncoder().encode(str));\n    bytes.alloc(U8).value = 0;\n    for (const ref of refs) ref.value.nameoff = offset - begin_dt_strings;\n  }\n  header.value.size_dt_strings = bytes.length - begin_dt_strings;\n\n  header.value.totalsize = bytes.length;\n  return bytes.array;\n}\n", "import {\n  FixedArray,\n  Struct,\n  type Type,\n  U16LE,\n  U32LE,\n  U64LE,\n  U8,\n} from \"./bytes.ts\";\nimport { assert } from \"./util.ts\";\nimport type { Imports } from \"./wasm.ts\";\n\nconst TransportFeatures = {\n  VERSION_1: 1n << 32n,\n  RING_PACKED: 1n << 34n,\n  INDIRECT_DESC: 1n << 28n,\n} as const;\n\nconst DescriptorFlags = {\n  NEXT: 1 << 0,\n  WRITE: 1 << 1,\n  INDIRECT: 1 << 2,\n  AVAIL: 1 << 7,\n  USED: 1 << 15,\n} as const;\n\nfunction formatDescFlags(flags: number) {\n  const f = [];\n  if (flags & DescriptorFlags.NEXT) f.push(\"NEXT\");\n  if (flags & DescriptorFlags.WRITE) f.push(\"WRITE\");\n  if (flags & DescriptorFlags.INDIRECT) f.push(\"INDIRECT\");\n  if (flags & DescriptorFlags.AVAIL) f.push(\"AVAIL\");\n  if (flags & DescriptorFlags.USED) f.push(\"USED\");\n  return f.join(\" \");\n}\n\nclass VirtqDescriptor extends Struct({\n  addr: U64LE,\n  len: U32LE,\n  id: U16LE,\n  flags: U16LE,\n}) {}\n\nclass Chain {\n  #mem: DataView;\n  #queue: Virtqueue;\n  id: number;\n  skip: number;\n  desc: VirtqDescriptor[];\n\n  constructor(\n    mem: DataView,\n    queue: Virtqueue,\n    id: number,\n    skip: number,\n    desc: VirtqDescriptor[],\n  ) {\n    this.#mem = mem;\n    this.#queue = queue;\n    this.id = id;\n    this.skip = skip;\n    this.desc = desc;\n  }\n\n  release(written: number) {\n    const queue = this.#queue;\n    const desc = queue.desc[queue.used_idx];\n    assert(desc);\n    const avail = (desc.flags & DescriptorFlags.AVAIL) !== 0;\n    const used = (desc.flags & DescriptorFlags.USED) !== 0;\n    if (avail === used || avail !== queue.wrap) throw new Error(\"ring full\");\n\n    let flags = 0;\n    if (queue.wrap) flags |= DescriptorFlags.AVAIL | DescriptorFlags.USED;\n    if (written > 0) flags |= DescriptorFlags.WRITE;\n\n    desc.id = this.id;\n    desc.len = written;\n    desc.flags = flags;\n\n    queue.used_idx += this.skip;\n    if (queue.used_idx >= queue.size) {\n      queue.used_idx -= queue.size;\n      queue.wrap = !queue.wrap;\n    }\n  }\n\n  *[Symbol.iterator]() {\n    for (const desc of this.desc) {\n      yield {\n        array: new Uint8Array(this.#mem.buffer, Number(desc.addr), desc.len),\n        writable: (desc.flags & DescriptorFlags.WRITE) !== 0,\n      };\n    }\n  }\n}\n\nclass Virtqueue {\n  #mem: DataView;\n\n  size: number;\n  desc: VirtqDescriptor[];\n  wrap = true;\n  used_idx = 0;\n  avail_idx = 0;\n\n  constructor(\n    mem: DataView,\n    size: number,\n    desc_addr: number,\n  ) {\n    assert(size !== 0);\n    assert(mem.byteOffset === 0);\n    this.#mem = mem;\n    this.size = size;\n    this.desc = FixedArray(VirtqDescriptor, size).get(mem, desc_addr);\n  }\n\n  #pop() {\n    let i = this.#advance();\n    if (i === null) return null;\n    const head = i;\n\n    let desc = this.desc[i];\n    assert(desc);\n\n    const chain = new Chain(\n      this.#mem,\n      this,\n      desc.id,\n      1,\n      this.desc.slice(head, i + 1),\n    );\n\n    if (desc.flags & DescriptorFlags.NEXT) {\n      do {\n        i = this.#advance();\n        if (i === null) throw new Error(\"no next descriptor is available\");\n        desc = this.desc[i];\n        assert(desc);\n      } while (desc.flags & DescriptorFlags.NEXT);\n      chain.skip = i - head + 1;\n      chain.desc = this.desc.slice(head, i + 1);\n    } else if (desc.flags & DescriptorFlags.INDIRECT) {\n      if (desc.len % VirtqDescriptor.size !== 0) {\n        throw new Error(\"malformed indirect buffer\");\n      }\n      chain.desc = FixedArray(VirtqDescriptor, desc.len / VirtqDescriptor.size)\n        .get(this.#mem, Number(desc.addr));\n    }\n\n    return chain;\n  }\n\n  *[Symbol.iterator]() {\n    let chain;\n    while (chain = this.#pop()) yield chain;\n  }\n\n  #advance() {\n    const desc = this.desc[this.avail_idx];\n    assert(desc);\n\n    const avail = (desc.flags & DescriptorFlags.AVAIL) !== 0;\n    const used = (desc.flags & DescriptorFlags.USED) !== 0;\n    if (avail === used || avail !== this.wrap) return null;\n\n    const index = this.avail_idx;\n    this.avail_idx = (this.avail_idx + 1) % this.size;\n    return index;\n  }\n}\n\nexport abstract class VirtioDevice<Config extends object = object> {\n  abstract readonly ID: number;\n  abstract config_bytes: Uint8Array;\n  abstract config: Config;\n\n  features = TransportFeatures.VERSION_1 | TransportFeatures.RING_PACKED |\n    TransportFeatures.INDIRECT_DESC;\n\n  trigger_interrupt = (kind: \"config\" | \"vring\"): void => {\n    // this function is overwritten on device setup\n    void kind;\n    throw new Error(\"trigger_interrupt called before setup\");\n  };\n\n  vqs: Virtqueue[] = [];\n  enable(vq: number, queue: Virtqueue) {\n    this.vqs[vq] = queue;\n  }\n  disable(vq: number) {\n    const queue = this.vqs[vq];\n    assert(queue);\n  }\n\n  abstract notify(vq: number): void;\n\n  setup_complete() {}\n}\n\nclass EmptyStruct extends Struct({}) {}\n\nconst BlockDeviceFeatures = {\n  RO: 1n << 5n,\n  FLUSH: 1n << 9n,\n} as const;\n\nclass BlockDeviceConfig extends Struct({\n  capacity: U64LE,\n}) {}\n\nclass BlockDeviceRequest extends Struct({\n  type: U32LE,\n  reserved: U32LE,\n  sector: U64LE,\n}) {}\n\nconst BlockDeviceRequestType = {\n  IN: 0,\n  OUT: 1,\n  FLUSH: 4,\n  GET_ID: 8,\n} as const;\n\nconst BlockDeviceStatus = {\n  OK: 0,\n  IOERR: 1,\n  UNSUPP: 2,\n} as const;\n\nexport class BlockDevice extends VirtioDevice<BlockDeviceConfig> {\n  ID = 2;\n  config_bytes = new Uint8Array(BlockDeviceConfig.size);\n  config = new BlockDeviceConfig(this.config_bytes);\n\n  #storage: Uint8Array;\n\n  constructor(storage: Uint8Array) {\n    super();\n    this.#storage = storage;\n    this.features |= BlockDeviceFeatures.FLUSH;\n    this.config.capacity = BigInt(this.#storage.byteLength / 512);\n  }\n\n  override notify(vq: number) {\n    assert(vq === 0);\n\n    const queue = this.vqs[vq];\n    assert(queue);\n\n    for (const chain of queue) {\n      const [header, data, status, trailing] = chain;\n      assert(header && !header.writable, \"header must be readonly\");\n      assert(\n        header.array.byteLength === BlockDeviceRequest.size,\n        `header size is ${header.array.byteLength}`,\n      );\n      assert(data, \"data must exist\");\n      assert(status && status.writable, \"status must be writable\");\n      assert(\n        status.array.byteLength === 1,\n        `status size is ${status.array.byteLength}`,\n      );\n      assert(!trailing, \"too many descriptors\");\n\n      const request = new BlockDeviceRequest(header.array);\n\n      let n = 0;\n      switch (request.type) {\n        case BlockDeviceRequestType.IN: {\n          assert(data.writable, \"data must be writable when IN\");\n          const start = Number(request.sector) * 512;\n          let end = start + data.array.byteLength;\n          if (end >= this.#storage.length) end = this.#storage.length - 1;\n          data.array.set(this.#storage.subarray(start, end));\n          n = end - start;\n          status.array[0] = BlockDeviceStatus.OK;\n          break;\n        }\n        default:\n          console.error(\"unknown request type\", request.type);\n          status.array[0] = BlockDeviceStatus.UNSUPP;\n      }\n\n      chain.release(n);\n    }\n    this.trigger_interrupt(\"vring\");\n  }\n}\n\nexport class ConsoleDevice extends VirtioDevice<EmptyStruct> {\n  ID = 3;\n  config_bytes = new Uint8Array(0);\n  config = new EmptyStruct(this.config_bytes);\n\n  #input: ReadableStream<Uint8Array>;\n  #output: WritableStreamDefaultWriter<Uint8Array>;\n  constructor(\n    input: ReadableStream<Uint8Array>,\n    output: WritableStream<Uint8Array>,\n  ) {\n    super();\n    this.#input = input;\n    this.#output = output.getWriter();\n  }\n\n  #writing: Promise<void> | null = null;\n  async #writer(queue: Virtqueue) {\n    const queue_iter = queue[Symbol.iterator]();\n    const reader = this.#input.getReader();\n    for (;;) {\n      const { value, done } = await reader.read();\n      if (done) break;\n      let chunk = value;\n\n      while (chunk.length > 0) {\n        const chain = queue_iter.next().value;\n        if (!chain) {\n          console.warn(\"no more descriptors, dropping console input\");\n          break;\n        }\n\n        const [desc, trailing] = chain;\n        assert(desc && desc.writable, \"receiver must be writable\");\n        assert(!trailing, \"too many descriptors\");\n\n        const n = Math.min(chunk.length, desc.array.byteLength);\n        desc.array.set(chunk.subarray(0, n));\n        chunk = chunk.subarray(n);\n        chain.release(n);\n      }\n      this.trigger_interrupt(\"vring\");\n    }\n  }\n\n  override async notify(vq: number) {\n    const queue = this.vqs[vq];\n    assert(queue);\n\n    switch (vq) {\n      case 0:\n        this.#writing ??= this.#writer(queue);\n        break;\n      case 1:\n        for (const chain of queue) {\n          let n = 0;\n          for (const { array, writable } of chain) {\n            assert(!writable, \"transmitter must be readable\");\n            await this.#output.write(array);\n            n += array.byteLength;\n          }\n          chain.release(n);\n        }\n        break;\n      default:\n        console.error(\"ConsoleDevice: unknown vq\", vq);\n    }\n  }\n}\n\nexport class EntropyDevice extends VirtioDevice<EmptyStruct> {\n  ID = 4;\n  config_bytes = new Uint8Array(0);\n  config = new EmptyStruct(this.config_bytes);\n\n  override notify(vq: number) {\n    assert(vq === 0);\n\n    const queue = this.vqs[vq];\n    assert(queue);\n\n    for (const chain of queue) {\n      let n = 0;\n      for (const { array, writable } of chain) {\n        assert(writable);\n\n        // can't use crypto.getRandomValues on a SharedArrayBuffer\n        const arr = new Uint8Array(array.length);\n        crypto.getRandomValues(arr);\n        array.set(arr);\n\n        n += array.byteLength;\n      }\n      chain.release(n);\n    }\n\n    this.trigger_interrupt(\"vring\");\n  }\n}\n\nexport function virtio_imports(\n  {\n    memory,\n    devices,\n    trigger_irq_for_cpu,\n  }: {\n    memory: WebAssembly.Memory;\n    devices: VirtioDevice[];\n    trigger_irq_for_cpu: (cpu: number, irq: number) => void;\n  },\n): Imports[\"virtio\"] {\n  const dv = new DataView(memory.buffer);\n\n  return {\n    set_features(dev, features) {\n      const device = devices[dev];\n      assert(device);\n      assert(\n        device.features === features,\n        \"the kernel should accept every feature we offer, and no more\",\n      );\n    },\n\n    enable_vring(dev, vq, size, desc_addr) {\n      const device = devices[dev];\n      assert(device);\n      device.enable(\n        vq,\n        new Virtqueue(dv, size, desc_addr),\n      );\n    },\n    disable_vring(dev, vq) {\n      const device = devices[dev];\n      assert(device);\n      device.disable(vq);\n    },\n\n    setup(\n      dev,\n      irq,\n      is_config_addr,\n      is_vring_addr,\n      config_addr,\n      config_len,\n    ) {\n      const device = devices[dev];\n      assert(device);\n\n      const config_type = device.config.constructor as unknown as Type<object>;\n      assert(config_len >= config_type.size, \"config space too small\");\n\n      const new_config_bytes = new Uint8Array(\n        dv.buffer,\n        config_addr,\n        config_len,\n      );\n      new_config_bytes.set(device.config_bytes);\n      device.config_bytes = new_config_bytes;\n      device.config = config_type.get(dv, config_addr);\n\n      device.trigger_interrupt = (kind) => {\n        U8.set(dv, is_config_addr, kind === \"config\" ? 1 : 0);\n        U8.set(dv, is_vring_addr, kind === \"vring\" ? 1 : 0);\n        trigger_irq_for_cpu(0, irq); // TODO: balance?\n      };\n\n      device.setup_complete();\n    },\n\n    notify(dev, vq) {\n      const device = devices[dev];\n      assert(device);\n      device.notify(vq);\n    },\n  };\n}\n", "import initramfs from \"./build/initramfs_data.cpio\";\nimport sections from \"./build/sections.json\" with { type: \"json\" };\nimport vmlinuxUrl from \"./build/vmlinux.wasm\";\nimport { type DeviceTreeNode, generate_devicetree } from \"./devicetree.ts\";\nimport { assert, EventEmitter, get_script_path, unreachable } from \"./util.ts\";\nimport { virtio_imports, VirtioDevice } from \"./virtio.ts\";\nimport { type Imports, type Instance, kernel_imports } from \"./wasm.ts\";\nimport type { InitMessage, WorkerMessage } from \"./worker.ts\";\n\nexport { BlockDevice, ConsoleDevice, EntropyDevice } from \"./virtio.ts\";\n\nconst worker_url = get_script_path(() => import(\"./worker.ts\"), import.meta);\n\nconst vmlinux_response = fetch(new URL(vmlinuxUrl, import.meta.url));\nconst vmlinux_promise = \"compileStreaming\" in WebAssembly\n  ? WebAssembly.compileStreaming(vmlinux_response)\n  : vmlinux_response.then((r) => r.arrayBuffer()).then(WebAssembly.compile);\n\nconst INITCPIO_ADDR = 0x200000;\n\nexport class Machine extends EventEmitter<{ error: ErrorEvent }> {\n  #boot_console: TransformStream<Uint8Array, Uint8Array>;\n  #boot_console_writer: WritableStreamDefaultWriter<Uint8Array>;\n  #workers: Worker[] = [];\n  #memory: WebAssembly.Memory;\n  #devices: VirtioDevice[];\n  #initcpio?: ArrayBufferView;\n\n  memory: Uint8Array;\n  devicetree: DeviceTreeNode;\n\n  get bootConsole() {\n    return this.#boot_console.readable;\n  }\n\n  constructor(options: {\n    cmdline?: string;\n    memoryMib?: number;\n    cpus?: number;\n    devices: VirtioDevice[];\n    initcpio?: ArrayBufferView;\n  }) {\n    super();\n    this.#boot_console = new TransformStream<Uint8Array, Uint8Array>();\n    this.#boot_console_writer = this.#boot_console.writable.getWriter();\n    this.#devices = options.devices;\n    this.#initcpio = options.initcpio;\n\n    const PAGE_SIZE = 0x10000;\n    const BYTES_PER_MIB = 0x100000;\n    const bytes = (options.memoryMib ?? 128) * BYTES_PER_MIB;\n    const pages = bytes / PAGE_SIZE;\n    this.#memory = new WebAssembly.Memory({\n      initial: pages,\n      maximum: pages,\n      shared: true,\n    });\n    assert(this.#memory.buffer.byteLength === bytes);\n    this.memory = new Uint8Array(this.#memory.buffer);\n\n    this.devicetree = {\n      \"#address-cells\": 1,\n      \"#size-cells\": 1,\n      chosen: {\n        \"rng-seed\": crypto.getRandomValues(new Uint8Array(64)),\n        bootargs: `console=hvc0 ${options.cmdline ?? \"\"}`,\n        ncpus: options.cpus ?? navigator.hardwareConcurrency,\n        sections,\n      },\n      aliases: {},\n      memory: {\n        device_type: \"memory\",\n        reg: [0, bytes],\n      },\n      \"reserved-memory\": {\n        \"#address-cells\": 1,\n        \"#size-cells\": 1,\n        ranges: undefined,\n      },\n    };\n\n    if (this.#initcpio) {\n      const chosen = this.devicetree.chosen as DeviceTreeNode;\n      chosen[\"linux,initrd-start\"] = INITCPIO_ADDR;\n      chosen[\"linux,initrd-end\"] = INITCPIO_ADDR + this.#initcpio.byteLength;\n\n      this.memory.set(\n        new Uint8Array(\n          this.#initcpio.buffer,\n          this.#initcpio.byteOffset,\n          this.#initcpio.byteLength,\n        ),\n        INITCPIO_ADDR,\n      );\n    }\n\n    for (const [i, dev] of this.#devices.entries()) {\n      this.devicetree[`virtio${i}`] = {\n        compatible: `virtio,wasm`,\n        \"host-id\": i,\n        \"virtio-device-id\": dev.ID,\n        features: dev.features,\n        config: dev.config_bytes,\n      };\n    }\n  }\n\n  async boot() {\n    const memory_reservations: { address: number; size: number }[] = [];\n    if (this.#initcpio) {\n      memory_reservations.push({\n        address: INITCPIO_ADDR,\n        size: this.#initcpio.byteLength,\n      });\n    }\n\n    const devicetree = generate_devicetree(this.devicetree, {\n      memory_reservations,\n    });\n    const vmlinux = await vmlinux_promise;\n\n    const boot_console_write = (message: ArrayBuffer) => {\n      this.#boot_console_writer.write(new Uint8Array(message)).catch(() => {\n        // Ignore errors if the console is closed\n      });\n    };\n    const boot_console_close = () => {\n      this.#boot_console_writer.close();\n    };\n\n    const spawn_worker = (\n      fn: number,\n      arg: number,\n      name: string,\n      user_module: WebAssembly.Module | null,\n      user_memory: WebAssembly.Memory | null,\n    ) => {\n      const worker = new Worker(worker_url, { type: \"module\", name });\n      this.#workers.push(worker);\n      worker.onmessage = (event: MessageEvent<WorkerMessage>) => {\n        switch (event.data.type) {\n          case \"spawn_worker\":\n            spawn_worker(\n              event.data.fn,\n              event.data.arg,\n              event.data.name,\n              event.data.user_module,\n              event.data.user_memory,\n            );\n            break;\n          case \"boot_console_write\":\n            boot_console_write(event.data.message);\n            break;\n          case \"boot_console_close\":\n            boot_console_close();\n            break;\n          case \"run_on_main\":\n            instance.exports.__indirect_function_table\n              .get(event.data.fn)!(event.data.arg);\n            break;\n          default:\n            unreachable(event.data);\n        }\n      };\n      worker.onerror = (event) => {\n        this.emit(\"error\", event);\n      };\n      worker.postMessage(\n        {\n          fn,\n          arg,\n          vmlinux,\n          memory: this.#memory,\n          parent_user_module: user_module,\n          parent_user_memory: user_memory,\n        } satisfies InitMessage,\n      );\n    };\n\n    const unavailable = () => {\n      throw new Error(\"not available on main thread\");\n    };\n\n    const imports = {\n      env: { memory: this.#memory },\n      boot: {\n        get_devicetree: (buf, size) => {\n          assert(size >= devicetree.byteLength, \"Device tree truncated\");\n          this.memory.set(devicetree, buf);\n        },\n        get_initramfs: (buf, size) => {\n          assert(size >= initramfs.byteLength, \"Initramfs truncated\");\n          this.memory.set(initramfs, buf);\n          return initramfs.byteLength;\n        },\n      },\n      kernel: kernel_imports({\n        is_worker: false,\n        memory: this.#memory,\n        spawn_worker,\n        boot_console_write,\n        boot_console_close,\n        run_on_main: unavailable,\n        get_user_module: unavailable,\n        get_user_memory: unavailable,\n      }),\n      user: {\n        compile: unavailable,\n        instantiate: unavailable,\n        call: unavailable,\n        switch_entry: unavailable,\n        call_signal_handler: unavailable,\n        read: unavailable,\n        write: unavailable,\n        write_zeroes: unavailable,\n      },\n      virtio: virtio_imports({\n        memory: this.#memory,\n        devices: this.#devices,\n        trigger_irq_for_cpu(cpu, irq) {\n          instance.exports.trigger_irq_for_cpu(cpu, irq);\n        },\n      }),\n    } satisfies Imports;\n\n    const instance =\n      (await WebAssembly.instantiate(vmlinux, imports)) as Instance;\n    instance.exports.boot();\n  }\n}\n"],
  "mappings": "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",
  "names": ["name"]
}
